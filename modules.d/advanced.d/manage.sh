#!/bin/bash

### =================================================================================
# @åç§°:         manage.sh
# @åŠŸèƒ½æè¿°:     è¯ä¹¦ç®¡ç†
# @ä½œè€…:         oliver556
# @ç‰ˆæœ¬:         0.1.0
# @åˆ›å»ºæ—¥æœŸ:     2025-07-18
# @ä¿®æ”¹æ—¥æœŸ:     2025-07-25
#
# @è®¸å¯è¯:       MIT
### =================================================================================
#
# =================================================================================
# SSL Certificate Application & Auto-Renewal Script (Optimized Version)
#
# åŠŸèƒ½:
# 1. è‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿå¹¶å®‰è£…æ‰€éœ€ä¾èµ– (curl, socat, cron)ã€‚
# 2. å¼•å¯¼ç”¨æˆ·è¾“å…¥åŸŸåã€é‚®ç®±ç­‰ä¿¡æ¯ã€‚
# 3. è‡ªåŠ¨å®‰è£…å®˜æ–¹ acme.sh å·¥å…·ã€‚
# 4. æ™ºèƒ½é…ç½®é˜²ç«å¢™ï¼Œä»…æ”¾è¡Œ 80 ç«¯å£ç”¨äºéªŒè¯ã€‚
# 5. ç”³è¯·ã€é¢å‘ï¼Œå¹¶å°†è¯ä¹¦å’Œç§é’¥å®‰è£…åˆ°è§„èŒƒã€å®‰å…¨çš„ç›®å½•ã€‚
# 6. è‡ªåŠ¨è®¾ç½® Cron å®šæ—¶ä»»åŠ¡ï¼Œå®ç°è¯ä¹¦è‡ªåŠ¨ç»­æœŸã€‚
#
# =================================================================================

### === å¯¼å…¥è¯ä¹¦ç®¡ç†è„šæœ¬ === ###
source "$ROOT_DIR/shell_scripts/advanced/setup-ssl.sh"

### === è¯ä¹¦ç®¡ç† ä¸»èœå• === ###
#
# @æè¿°
#   æœ¬å‡½æ•°ç”¨äºæ˜¾ç¤ºè¯ä¹¦ç®¡ç†ä¸»èœå•ã€‚
#
# @ç¤ºä¾‹
#   advanced_manage_menu
###
advanced_manage_menu() {
    while true; do
        clear
        sub_menu_title "ğŸ–¥ï¸  SSL è¯ä¹¦ç®¡ç†é¢æ¿"
        print_echo_line_1
        echo -e "${LIGHT_CYAN}1.  ${WHITE}ç”³è¯· SSL è¯ä¹¦"
        echo -e "${LIGHT_CYAN}2.  ${WHITE}æŸ¥çœ‹å·²ç”³è¯·çš„åŸŸå"
        echo -e "${LIGHT_CYAN}3.  ${WHITE}é‡ç½®ç¯å¢ƒï¼ˆæ¸…é™¤ç”³è¯·è®°å½•å¹¶é‡æ–°éƒ¨ç½²ï¼‰"
        print_echo_line_1
        echo -e "${LIGHT_CYAN}0.  ${WHITE}è¿”å›ä¸»èœå•"
        print_echo_line_1
        echo ""
        read -rp "ğŸ‘‰ è¯·è¾“å…¥ä½ çš„é€‰æ‹©: " MAIN_OPTION

        case $MAIN_OPTION in
            1)
                get_ssl_interaction
                ;;
            2)
                list_issued_domains
                ;;
            3)
                reset_environment
                ;;
            # è¿”å›ä¸»èœå•
            0) break ;;
            *) echo "âŒ æ— æ•ˆé€‰é¡¹ï¼Œè¯·é‡æ–°è¾“å…¥ã€‚" && sleep 1 ;;
        esac
    done
}